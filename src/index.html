<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wafer Map Dashboard v4.1 - Refactored</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî¨</text></svg>">
    
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Fonts and Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body class="text-slate-800">
    <div id="dashboard-page" class="min-h-screen">
        <!-- Header -->
        <header class="bg-white px-6 py-3 border-b flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold text-slate-900">Wafer Map Dashboard v4.2.0 <span class="text-sm font-normal text-blue-600">(ÎπåÎìúÏ†ïÎ≥¥: 2025-06-22 21:00)</span></h1>
                <p class="text-sm text-slate-500">Î∞òÎèÑÏ≤¥ ÌíàÏßà Í¥ÄÎ¶¨ ÌÜµÌï© ÎåÄÏãúÎ≥¥Îìú (PDF Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ± Í∏∞Îä• Ï∂îÍ∞Ä)</p>
            </div>
        </header>

        <!-- Navigation -->
        <nav id="main-tabs" class="flex border-b bg-slate-50">
            <button data-tab="summary" class="main-tab py-4 px-6 border-b-2 font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300 active">Summary</button>
            <button data-tab="map-analysis" class="main-tab py-4 px-6 border-b-2 font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">MAPÎ∂ÑÏÑù</button>
            <button data-tab="test-analysis" class="main-tab py-4 px-6 border-b-2 font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">Test Analysis</button>
            <button data-tab="binning-analysis" class="main-tab py-4 px-6 border-b-2 font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">Binning Analysis</button>
            <button data-tab="risk-assessment" class="main-tab py-4 px-6 border-b-2 font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">RISKÌèâÍ∞Ä</button>
            <button data-tab="final-test" class="main-tab py-4 px-6 border-b-2 font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">Final Test</button>
        </nav>

        <!-- Main Content -->
        <main class="p-6">
            <!-- Summary Tab -->
            <div id="summary-tab" class="tab-content">
                <div class="mb-6">
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">üìä Wafer Map Dashboard Overview</h1>
                    <p class="text-gray-600">Comprehensive semiconductor wafer testing and analysis platform</p>
                </div>

                <!-- Quick Stats Overview -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-blue-100 rounded-lg">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Total Files</p>
                                <p id="summary-total-files" class="text-2xl font-bold text-gray-900">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-green-100 rounded-lg">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Overall Yield</p>
                                <p id="summary-overall-yield" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-purple-100 rounded-lg">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Total Lots</p>
                                <p id="summary-total-lots" class="text-2xl font-bold text-gray-900">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-yellow-100 rounded-lg">
                                <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Last Updated</p>
                                <p id="summary-last-updated" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Welcome Message -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
                    <h2 class="text-xl font-semibold text-blue-800 mb-3">üöÄ Welcome to Wafer Map Dashboard v4.2.0</h2>
                    <p class="text-blue-700 mb-4">
                        This dashboard provides comprehensive analysis tools for semiconductor wafer testing data with professional PDF report generation. 
                        Upload your STDF summary files to get started with detailed analytics and generate comprehensive reports.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                        <div class="bg-white p-3 rounded border">
                            <h3 class="font-semibold text-gray-800 mb-1">üìÅ File Upload</h3>
                            <p class="text-gray-600">Upload .lotSumTXT files in the Final Test tab</p>
                        </div>
                        <div class="bg-white p-3 rounded border">
                            <h3 class="font-semibold text-gray-800 mb-1">üìä Analysis</h3>
                            <p class="text-gray-600">View detailed test and binning analysis</p>
                        </div>
                        <div class="bg-white p-3 rounded border">
                            <h3 class="font-semibold text-gray-800 mb-1">üìÑ PDF Reports</h3>
                            <p class="text-gray-600">Generate comprehensive 7-page PDF reports with professional formatting</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MAP Analysis Tab -->
            <div id="map-analysis-tab" class="tab-content hidden">
                <p class="text-slate-600">(Í∏∞Ï°¥ MAP Î∂ÑÏÑù ÌÉ≠ ÎÇ¥Ïö©...)</p>
            </div>

            <!-- Test Analysis Tab -->
            <div id="test-analysis-tab" class="tab-content hidden">
                <div class="mb-6">
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">üî¨ Test Analysis Dashboard</h1>
                    <p class="text-gray-600">Comprehensive test performance analysis and optimization insights</p>
                </div>

                <!-- Test Analysis Controls -->
                <div class="mb-6 p-4 bg-blue-50 rounded-lg">
                    <div class="flex flex-wrap gap-4 items-center">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Test Type Filter</label>
                            <select id="test-type-filter" class="border border-gray-300 rounded px-3 py-2 text-sm">
                                <option value="all">All Tests</option>
                                <option value="dc">DC Tests</option>
                                <option value="ac">AC Tests</option>
                                <option value="functional">Functional Tests</option>
                                <option value="parametric">Parametric Tests</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Time Range</label>
                            <select id="time-range-filter" class="border border-gray-300 rounded px-3 py-2 text-sm">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                                <option value="all">All Time</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Device Filter</label>
                            <select id="device-filter" class="border border-gray-300 rounded px-3 py-2 text-sm">
                                <option value="all">All Devices</option>
                            </select>
                        </div>
                        <button id="refresh-test-analysis" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm">
                            üîÑ Refresh Analysis
                        </button>
                    </div>
                </div>

                <!-- Test Performance Overview -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-green-100 rounded-lg">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Overall Yield</p>
                                <p id="overall-yield" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-blue-100 rounded-lg">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Test Time</p>
                                <p id="avg-test-time" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-yellow-100 rounded-lg">
                                <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Failure Rate</p>
                                <p id="failure-rate" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-purple-100 rounded-lg">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Test Count</p>
                                <p id="total-tests" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Test Analysis Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Test Yield Trend -->
                    <div class="bg-white p-6 rounded-lg shadow border">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">üìà Test Yield Trend</h3>
                        <div class="relative" style="height: 256px;">
                            <canvas id="test-yield-chart"></canvas>
                        </div>
                    </div>

                    <!-- Test Failure Distribution -->
                    <div class="bg-white p-6 rounded-lg shadow border">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">üéØ Test Failure Distribution</h3>
                        <div class="relative" style="height: 256px;">
                            <canvas id="test-failure-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Test Performance Table -->
                <div class="bg-white rounded-lg shadow border">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-semibold text-gray-800">üìä Test Performance Details</h3>
                    </div>
                    <div class="">
                        <table id="test-performance-table" class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Test Name</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Yield (%)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fail Count</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Time (ms)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="test-performance-tbody" class="bg-white divide-y divide-gray-200">
                                <!-- Test rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Test Optimization Recommendations -->
                <div class="mt-6 bg-white rounded-lg shadow border">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-semibold text-gray-800">üí° Test Optimization Recommendations</h3>
                    </div>
                    <div id="test-recommendations" class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Recommendations will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Binning Analysis Tab -->
            <div id="binning-analysis-tab" class="tab-content hidden">
                <div class="mb-6">
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">üì¶ Binning Analysis Dashboard</h1>
                    <p class="text-gray-600">Advanced binning analysis and yield optimization insights</p>
                </div>

                <!-- Binning Analysis Controls -->
                <div class="mb-6 p-4 bg-green-50 rounded-lg">
                    <div class="flex flex-wrap gap-4 items-center">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Bin Category</label>
                            <select id="bin-category-filter" class="border border-gray-300 rounded px-3 py-2 text-sm">
                                <option value="all">All Bins</option>
                                <option value="pass">Pass Bins</option>
                                <option value="fail">Fail Bins</option>
                                <option value="marginal">Marginal Bins</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Analysis Period</label>
                            <select id="bin-period-filter" class="border border-gray-300 rounded px-3 py-2 text-sm">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                                <option value="all">All Time</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Sort By</label>
                            <select id="bin-sort-filter" class="border border-gray-300 rounded px-3 py-2 text-sm">
                                <option value="count">Count</option>
                                <option value="percentage">Percentage</option>
                                <option value="trend">Trend</option>
                            </select>
                        </div>
                        <button id="refresh-binning-analysis" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm">
                            üîÑ Refresh Analysis
                        </button>
                    </div>
                </div>

                <!-- Binning Overview Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-green-100 rounded-lg">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Total Bins</p>
                                <p id="total-bins" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-blue-100 rounded-lg">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Pass Rate</p>
                                <p id="pass-rate" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-red-100 rounded-lg">
                                <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Fail Rate</p>
                                <p id="fail-rate" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center">
                            <div class="p-2 bg-yellow-100 rounded-lg">
                                <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm font-medium text-gray-500">Marginal Rate</p>
                                <p id="marginal-rate" class="text-2xl font-bold text-gray-900">--</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Binning Analysis Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Bin Distribution Chart -->
                    <div class="bg-white p-6 rounded-lg shadow border">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">üìä Bin Distribution</h3>
                        <div class="relative" style="height: 256px;">
                            <canvas id="bin-distribution-chart"></canvas>
                        </div>
                    </div>

                    <!-- Bin Trend Analysis -->
                    <div class="bg-white p-6 rounded-lg shadow border">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">üìà Bin Trend Analysis</h3>
                        <div class="relative" style="height: 256px;">
                            <canvas id="bin-trend-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Binning Details Table -->
                <div class="bg-white rounded-lg shadow border">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-semibold text-gray-800">üìã Binning Details</h3>
                    </div>
                    <div class="">
                        <table id="binning-details-table" class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bin Code</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Count</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Percentage</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trend</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="binning-details-tbody" class="bg-white divide-y divide-gray-200">
                                <!-- Bin rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Binning Optimization Insights -->
                <div class="mt-6 bg-white rounded-lg shadow border">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-semibold text-gray-800">üí° Binning Optimization Insights</h3>
                    </div>
                    <div id="binning-insights" class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Yield Improvement Opportunities -->
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-blue-800 mb-2">üéØ Yield Improvement Opportunities</h4>
                                <div id="yield-opportunities" class="space-y-2">
                                    <!-- Opportunities will be populated here -->
                                </div>
                            </div>
                            
                            <!-- Bin Consolidation Suggestions -->
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-green-800 mb-2">üîß Bin Consolidation Suggestions</h4>
                                <div id="consolidation-suggestions" class="space-y-2">
                                    <!-- Suggestions will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RISK Assessment Tab -->
            <div id="risk-assessment-tab" class="tab-content hidden">
                <p class="text-slate-600">(Í∏∞Ï°¥ RISK ÌèâÍ∞Ä ÌÉ≠ ÎÇ¥Ïö©...)</p>
            </div>

            <!-- Final Test Tab -->
            <div id="final-test-tab" class="tab-content hidden">
                <!-- File Upload Section -->
                <div class="mb-4">
                    <button id="uploadBtn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                        ÌååÏùº ÏÑ†ÌÉù Î∞è ÏóÖÎ°úÎìú
                    </button>
                    <button id="debugBtn" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded ml-2">
                        üîç Debug Sequences
                    </button>
                    <button id="debugDataBtn" class="bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded ml-2">
                        üî¨ Debug Parsed Data
                    </button>
                </div>

                <!-- File Input -->
                <div class="mb-6">
                    <label class="block mb-2 font-semibold">Final Test Summary ÌååÏùº ÏóÖÎ°úÎìú (.lotSumTXT)</label>
                    <input type="file" id="final-test-upload" accept=".lotSumTXT" multiple class="block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" />
                    <p class="text-xs text-slate-500 mt-1">Ïó¨Îü¨ Final Test ÏöîÏïΩ ÌååÏùºÏùÑ ÏóÖÎ°úÎìúÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                </div>

                <!-- Loading State -->
                <div id="final-test-loading" class="hidden text-center py-8">
                    <div class="loader mx-auto"></div>
                    <p class="mt-4 text-slate-600">ÌååÏùºÏùÑ Î∂ÑÏÑù Ï§ëÏûÖÎãàÎã§...</p>
                </div>

                <!-- Results Section -->
                <div id="final-test-result" class="hidden">
                    <!-- Multi-File Summary -->
                    <div id="multi-file-summary" class="mb-6 p-4 bg-blue-50 rounded-lg">
                        <h2 class="text-lg font-bold mb-2 text-blue-800">üìä Multi-File Summary</h2>
                        <div id="file-summary-stats" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"></div>
                        <div id="aggregated-yield" class="bg-white p-3 rounded shadow">
                            <h3 class="font-semibold mb-2">Aggregated Yield Analysis</h3>
                            <div id="aggregated-stats" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
                            <div class="mt-4 flex gap-2">
                                <button id="generate-report" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 text-sm font-semibold shadow-lg transition-all duration-200 transform hover:scale-105">
                                    üìÑ Generate Comprehensive Report
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Lot Comparison -->
                    <div id="lot-comparison" class="mb-6 p-4 bg-green-50 rounded-lg">
                        <div class="flex justify-between items-center mb-3">
                            <h2 class="text-lg font-bold text-green-800">üìà Lot Comparison</h2>
                            <div class="flex items-center space-x-2">
                                <button id="reset-table-width" class="px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600">
                                    üîÑ Reset Width
                                </button>
                                <button id="fit-content-width" class="px-3 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600">
                                    üìè Fit Content
                                </button>
                                <button id="print-friendly-width" class="px-3 py-1 bg-purple-500 text-white rounded text-xs hover:bg-purple-600">
                                    üñ®Ô∏è Print Width
                                </button>
                            </div>
                        </div>
                        <div id="lot-comparison-table-container" class="bg-white rounded-lg border relative">
                            <div class="resize-handle absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                            <div class="overflow-x-auto" style="max-width: 1200px; min-width: 800px;">
                                <table id="lot-comparison-table" class="w-full text-sm table-fixed">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="p-2 text-left font-medium text-gray-700">Lot Number</th>
                                            <th class="p-2 text-center font-medium text-gray-700">Device</th>
                                            <th class="p-2 text-center font-medium text-gray-700">Lot Size</th>
                                            <th class="p-2 text-center font-medium text-gray-700">Yield (%)</th>
                                            <th class="p-2 text-center font-medium text-gray-700">Pass</th>
                                            <th class="p-2 text-center font-medium text-gray-700">Fail</th>
                                            <th class="p-2 text-center font-medium text-gray-700">Test Date</th>
                                            <th class="p-2 text-center font-medium text-gray-700">Operator</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Lot comparison data will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="mt-2 text-xs text-gray-600">
                            üí° <strong>Tip:</strong> Drag the right edge to resize table width. Use buttons above for preset widths.
                        </div>
                    </div>
                    
                    <!-- Selected Lot Details -->
                    <div id="selected-lot-section" class="mt-6 hidden">
                        <!-- Lot Specific Analytics -->
                        <div class="p-6 bg-gradient-to-br from-gray-50 to-blue-50 rounded-xl border border-gray-200 shadow-lg">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                                    <span class="text-3xl mr-3">üîç</span>
                                    Lot Specific Analytics
                                </h2>
                                <div class="flex items-center space-x-2">
                                    <button id="reset-analytics-width" class="px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600">
                                        üîÑ Reset Width
                                    </button>
                                    <button id="fit-analytics-content" class="px-3 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600">
                                        üìè Fit Content
                                    </button>
                                    <button id="print-analytics-width" class="px-3 py-1 bg-purple-500 text-white rounded text-xs hover:bg-purple-600">
                                        üñ®Ô∏è Print Width
                                    </button>
                                </div>
                            </div>
                            
                            <div id="lot-analytics-container" class="relative">
                                <div class="resize-handle absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                                <div class="overflow-x-auto" style="max-width: 1400px; min-width: 1000px;">
                                    
                                    <!-- Zone 1: Lot Info, Test Summary, Quality Metrics -->
                                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6 h-equal">
                                        <div id="selected-lot-info" class="h-full relative resizable-card">
                                            <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                                            <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                                                <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                                                <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                                                <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                                            </div>
                                        </div>
                                        <div id="selected-lot-summary" class="h-full relative resizable-card">
                                            <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                                            <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                                                <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                                                <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                                                <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                                            </div>
                                        </div>
                                        <div id="selected-lot-quality" class="h-full relative resizable-card">
                                            <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                                            <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                                                <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                                                <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                                                <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Zone 2: Re-test Flow, Failure Analysis -->
                                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-equal">
                                        <div id="selected-lot-retest-flow" class="h-full relative resizable-card">
                                            <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                                            <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                                                <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                                                <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                                                <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                                            </div>
                                        </div>
                                        <div id="selected-lot-failure-analysis" class="h-full relative resizable-card">
                                            <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                                            <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                                                <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                                                <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                                                <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="mt-2 text-xs text-gray-600">
                                üí° <strong>Tip:</strong> Drag the right edge to resize analytics width. Use buttons above for preset widths.
                            </div>
                        </div>

                        <!-- Lot Hard Bin Sorting Table -->
                        <div id="hard-bin-table-container" class="mt-6 relative resizable-card">
                            <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                            <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                                <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                                <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                                <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                            </div>
                            <div class="bg-white rounded-lg shadow border">
                                <div class="p-6 border-b">
                                    <h3 class="text-lg font-semibold text-gray-800">üìä Hard Bin Sorting Table</h3>
                                </div>
                                <div class="">
                                    <table id="hard-bin-table" class="w-full">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bin Code</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Count</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Percentage</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                            </tr>
                                        </thead>
                                        <tbody id="hard-bin-tbody" class="bg-white divide-y divide-gray-200">
                                            <!-- Hard bin data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Test Results by Site -->
                        <div class="mt-6 relative resizable-card">
                            <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                            <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                                <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                                <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                                <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                            </div>
                            <h2 class="text-lg font-bold mb-2 text-gray-700">üìã Test Í≤∞Í≥º ÏÉÅÏÑ∏ (SiteÎ≥Ñ)</h2>
                            <div id="test-stage-tabs" class="border-b border-gray-200 mb-2 flex space-x-4">
                                <!-- Test stage tabs will be injected here -->
                            </div>
                            <div id="test-results-container">
                                <!-- Test results tables will be injected here -->
                            </div>
                        </div>
                    </div>

                    <!-- Aggregated Enhanced Analytics -->
                    <div id="enhanced-analytics" class="mt-6 mb-6 p-4 bg-purple-50 rounded-lg relative resizable-card">
                        <div class="resize-handle-card absolute right-0 top-0 bottom-0 w-1 bg-gray-300 cursor-col-resize hover:bg-blue-400 transition-colors"></div>
                        <div class="flex items-center space-x-1 absolute top-2 right-4 z-10">
                            <button class="reset-card-width px-1 py-0.5 bg-blue-200 text-xs rounded">üîÑ</button>
                            <button class="fit-card-width px-1 py-0.5 bg-green-200 text-xs rounded">üìè</button>
                            <button class="print-card-width px-1 py-0.5 bg-purple-200 text-xs rounded">üñ®Ô∏è</button>
                        </div>
                        <h2 class="text-lg font-bold mb-2 text-purple-800">üî¨ Aggregated Enhanced Analytics</h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div class="bg-white p-4 rounded shadow">
                                <h3 class="font-semibold mb-2 text-purple-700">üìà Yield Trend Analysis</h3>
                                <div id="trend-content"></div>
                            </div>
                            <div class="bg-white p-4 rounded shadow">
                                <h3 class="font-semibold mb-2 text-purple-700">üéØ Failure Pattern Analysis</h3>
                                <div id="pattern-content"></div>
                            </div>
                            <div class="bg-white p-4 rounded shadow">
                                <h3 class="font-semibold mb-2 text-purple-700">üè≠ Site Performance</h3>
                                <div id="site-content"></div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-white p-4 rounded shadow">
                                <h3 class="font-semibold mb-2 text-purple-700">üîó Failure Correlation Analysis</h3>
                                <div id="correlation-content"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Debug Information -->
                <div id="debug-info" class="mt-4 p-4 bg-gray-100 rounded text-xs hidden">
                    <h3 class="font-semibold mb-2">Debug Information:</h3>
                    <pre id="debug-content"></pre>
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript Bundle -->
    <script src="../dist/bundle.js"></script>
</body>
</html>